---
name: Create Pydantic schemas for all request/response types
status: closed
created: 2026-01-12T07:14:18Z
updated: 2026-01-12T07:24:05Z
completed: 2026-01-12T09:12:16Z
github: https://github.com/PATCoder97/fhs-prosight/issues/55
depends_on: []
parallel: true
conflicts_with: []
---

# Task: Create Pydantic schemas for all request/response types

## Description
Create comprehensive Pydantic schemas for validating requests and formatting responses across all PIDMS API endpoints. This includes 8 schemas covering check, sync, search, and products endpoints.

## Acceptance Criteria
- [ ] Schema file created at `backend/app/schemas/pidms.py`
- [ ] PIDMSKeyCheckRequest schema with keys field validation
- [ ] PIDMSKeyResponse schema with all 14 key fields + status
- [ ] PIDMSCheckResponse schema with success, summary, results
- [ ] PIDMSSyncRequest schema with optional product_filter
- [ ] PIDMSSyncResponse schema with success, summary, error_details
- [ ] PIDMSSearchResponse schema with pagination (total, page, page_size, results)
- [ ] PIDMSProductSummary schema with aggregated statistics
- [ ] PIDMSProductsResponse schema with products list
- [ ] Schemas imported in `backend/app/schemas/__init__.py`

## Technical Details

**File:** `backend/app/schemas/pidms.py`

**Key Schemas:**
```python
from pydantic import BaseModel, Field
from typing import List, Optional
from datetime import datetime

class PIDMSKeyCheckRequest(BaseModel):
    keys: str = Field(..., description="Newline or comma-separated list of product keys")

class PIDMSKeyResponse(BaseModel):
    id: Optional[int] = None
    keyname: str
    keyname_with_dash: str
    prd: str
    eid: Optional[str] = None
    is_key_type: Optional[str] = None
    is_retail: Optional[int] = None
    remaining: int
    blocked: int
    errorcode: Optional[str] = None
    sub: Optional[str] = None
    had_occurred: Optional[int] = None
    invalid: Optional[int] = None
    datetime_checked_done: Optional[str] = None
    created_at: Optional[datetime] = None
    updated_at: Optional[datetime] = None
    status: Optional[str] = None  # "new" or "updated"

    class Config:
        from_attributes = True

class PIDMSCheckSummary(BaseModel):
    total_keys: int
    new_keys: int
    updated_keys: int
    errors: int

class PIDMSCheckResponse(BaseModel):
    success: bool
    summary: PIDMSCheckSummary
    results: List[PIDMSKeyResponse]

class PIDMSSyncRequest(BaseModel):
    product_filter: Optional[str] = None

class PIDMSSyncResponse(BaseModel):
    success: bool
    summary: dict
    error_details: List[dict] = []

class PIDMSSearchResponse(BaseModel):
    total: int
    page: int
    page_size: int
    results: List[PIDMSKeyResponse]

class PIDMSProductSummary(BaseModel):
    prd: str
    key_count: int
    total_remaining: int
    avg_remaining: float
    low_inventory: bool

class PIDMSProductsResponse(BaseModel):
    products: List[PIDMSProductSummary]
```

**Files Affected:**
- `backend/app/schemas/pidms.py` (new)
- `backend/app/schemas/__init__.py` (update imports)

## Dependencies
- [ ] Pydantic library installed
- [ ] Understanding of API response formats from PRD

## Effort Estimate
- Size: S
- Hours: 2-3 hours
- Parallel: true (no dependencies on other tasks)

## Definition of Done
- [x] All 8+ schemas implemented
- [x] Field validation rules added (e.g., max lengths, required fields)
- [x] Config class with from_attributes for ORM compatibility
- [x] Schemas imported in __init__.py
- [x] Type hints verified with mypy
