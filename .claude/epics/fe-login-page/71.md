---
name: Error Handling & UX Polish
status: open
created: 2026-01-12T12:02:50Z
updated: 2026-01-12T12:11:36Z
github: https://github.com/PATCoder97/fhs-prosight/issues/71
depends_on: [68, 69, 70]
parallel: false
conflicts_with: []
---

# Task: Error Handling & UX Polish

## Description

ThÃªm error handling vÃ  UX improvements vÃ o login flow: hiá»ƒn thá»‹ error messages trÃªn login page khi OAuth fails, thÃªm loading states, vÃ  Ä‘áº£m báº£o error messages user-friendly.

## Acceptance Criteria

- [x] Login page hiá»ƒn thá»‹ error message khi cÃ³ query param `?error=...`
- [x] Error messages user-friendly:
  - `access_denied` â†’ "Báº¡n Ä‘Ã£ há»§y Ä‘Äƒng nháº­p. Vui lÃ²ng thá»­ láº¡i."
  - `invalid_token` â†’ "Token khÃ´ng há»£p lá»‡. Vui lÃ²ng thá»­ Ä‘Äƒng nháº­p láº¡i."
  - `no_token` â†’ "KhÃ´ng nháº­n Ä‘Æ°á»£c token. Vui lÃ²ng thá»­ Ä‘Äƒng nháº­p láº¡i."
  - Default â†’ "ÄÃ£ xáº£y ra lá»—i. Vui lÃ²ng thá»­ láº¡i."
- [x] Error message cÃ³ thá»ƒ dismiss (close button hoáº·c tá»± Ä‘á»™ng hide sau 5s)
- [x] Error message styling: VAlert component vá»›i color error/warning
- [x] Loading state trÃªn OAuth buttons khi click (optional - náº¿u cÃ³ thá»i gian)
- [x] Smooth transitions khi hiá»ƒn thá»‹/áº©n errors

## Technical Details

**File to modify:**
- `frontend/src/pages/login.vue`

**Implementation approach:**

1. **Detect error from URL:**
```vue
<script setup>
import { ref, onMounted } from 'vue'
import { useRoute, useRouter } from 'vue-router'

const route = useRoute()
const router = useRouter()

const errorMessage = ref('')

const errorMessages = {
  access_denied: 'Báº¡n Ä‘Ã£ há»§y Ä‘Äƒng nháº­p. Vui lÃ²ng thá»­ láº¡i.',
  invalid_token: 'Token khÃ´ng há»£p lá»‡. Vui lÃ²ng thá»­ Ä‘Äƒng nháº­p láº¡i.',
  no_token: 'KhÃ´ng nháº­n Ä‘Æ°á»£c token. Vui lÃ²ng thá»­ Ä‘Äƒng nháº­p láº¡i.',
  default: 'ÄÃ£ xáº£y ra lá»—i. Vui lÃ²ng thá»­ láº¡i.',
}

onMounted(() => {
  const error = route.query.error
  if (error) {
    errorMessage.value = errorMessages[error] || errorMessages.default

    // Clear error from URL (optional - clean URL)
    router.replace({ query: {} })

    // Auto-hide after 5 seconds (optional)
    setTimeout(() => {
      errorMessage.value = ''
    }, 5000)
  }
})

const dismissError = () => {
  errorMessage.value = ''
}
</script>
```

2. **Display error in template:**
```vue
<template>
  <!-- ... existing content ... -->

  <VCard flat :max-width="500" class="mt-12 mt-sm-0 pa-6">
    <!-- Error Alert -->
    <VAlert
      v-if="errorMessage"
      type="error"
      closable
      class="mb-4"
      @click:close="dismissError"
    >
      {{ errorMessage }}
    </VAlert>

    <!-- Welcome message -->
    <VCardText>
      <h4 class="text-h4 mb-1">
        Welcome to <span class="text-capitalize">{{ themeConfig.app.title }}</span>! ğŸ‘‹ğŸ»
      </h4>
      <p class="mb-6">
        Vui lÃ²ng Ä‘Äƒng nháº­p báº±ng tÃ i khoáº£n Google hoáº·c GitHub
      </p>
    </VCardText>

    <!-- OAuth Buttons -->
    <VCardText>
      <AuthProvider />
    </VCardText>
  </VCard>
</template>
```

**Optional enhancement - Loading state on buttons:**
Náº¿u cÃ³ thá»i gian, update AuthProvider.vue:
```vue
<script setup>
const isLoading = ref(false)

const loginWithOAuth = (provider) => {
  isLoading.value = true
  const baseUrl = import.meta.env.VITE_API_BASE_URL || 'http://127.0.0.1:8001'
  window.location.href = `${baseUrl}/api/auth/login/${provider.toLowerCase()}`
}
</script>

<template>
  <VBtn :loading="isLoading" @click="loginWithOAuth(provider.name)">
    ...
  </VBtn>
</template>
```

**UX considerations:**
- Error hiá»ƒn thá»‹ rÃµ rÃ ng á»Ÿ top cá»§a card
- Closable Ä‘á»ƒ user cÃ³ thá»ƒ dismiss
- Auto-hide sau 5s Ä‘á»ƒ khÃ´ng lÃ m phiá»n user
- Color: error (red) Ä‘á»ƒ dá»… nháº­n biáº¿t

## Dependencies

- [x] Task 68: Login page simplified
- [x] Task 69: Callback handler (táº¡o error redirects)
- [x] Task 70: Router configuration
- [x] Vuetify VAlert component

## Effort Estimate

- Size: S
- Hours: 2 hours
- Parallel: false (cáº§n Tasks 68, 69, 70 hoÃ n thÃ nh)

## Definition of Done

- [x] Error messages display correctly khi cÃ³ `?error=...` query param
- [x] All error codes cÃ³ user-friendly messages
- [x] Error alert cÃ³ close button vÃ  closable
- [x] Auto-hide after 5 seconds (optional)
- [x] Error alert styling matches Vuexy theme
- [x] Tested vá»›i má»—i error code:
  - Navigate to `/login?error=access_denied`
  - Navigate to `/login?error=invalid_token`
  - Navigate to `/login?error=no_token`
  - Navigate to `/login?error=unknown_error`
- [x] No console errors
- [x] No ESLint errors
